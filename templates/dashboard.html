{% extends "base.html" %}

{% block content %}
<!-- Main Content -->
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
    <div class="w-100">
        <h1 class="h2">Dashboard</h1>
        <p class="text-muted">Community issue reporting and tracking</p>
    </div>
    <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
            <button type="button" class="btn btn-md btn-dark">
                <a href="{{ url_for('report_issue') }}" class="text-decoration-none text-white">+ Report an Issue</a>
            </button>
        </div>
    </div>
</div>

<!-- Dashboard Content -->
<div class="dashboard-cards">
    <div class="card-metric card-total">
        <div class="metric-number text-dark">{{ reports|length }}</div>
        <div class="metric-label">Total Reports</div>
    </div>
    <div class="card-metric card-pending">
        <div class="metric-number text-warning">{{ pending_reports|length }}</div>
        <div class="metric-label">Pending Issues</div>
    </div>
    <div class="card-metric card-resolved">
        <div class="metric-number text-success">{{ resolved_reports|length }}</div>
        <div class="metric-label">Resolved Issues</div>
    </div>
    <div class="card-metric card-progress">
        <div class="metric-number">{{ in_progress_reports|length }}</div>
        <div class="metric-label">In Progress</div>
    </div>
</div>

<!-- Recent Reports Section -->
<div class="mt-4">
    <h3>Recent Reports</h3>
    <div class="table-responsive">
        <table class="table table-striped table-sm">
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Category</th>
                    <th scope="col">Description</th>
                    <th scope="col">Location</th>
                    <th scope="col">Status</th>
                    <th scope="col">Date</th>
                </tr>
            </thead>
            <tbody>
                {% for report in reports|reverse %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ report.category|title }}</td>
                    <td>{{ report.description|title }}</td>
                    <td>{{ report.area|title }}</td>
                    <td><span
                class="badge bg-{{ 'success' if report.status == 'resolved' else 'warning' if report.status == 'pending' else 'primary' if report.status == 'progress' else 'secondary' }}">
                {{ report.status|title }}
            </span></td>
                    <td>{{ report.created_at.strftime('%B %d, %Y at %I:%M %p') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}